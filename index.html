<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- Google fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500&display=swap" rel="stylesheet">
    <!-- My Css -->
    <link rel="stylesheet" href="index.css">
    <title>Json Search Work</title>
</head>

<body>

    <div class="multiselect-search">
            <input type="text" class="form-control" id="searchInput" aria-describedby="Search" placeholder="Search Names">

            <div class="btn-li-items">
                <p><span id="selected-check">Selected Items : 0</span> of <span id="visibleNum">107</span></p>
                <button type="button" class="btn btn-info checkall">Toggle Select</button>
            </div>

        <div id="div_id_cell" class="form-group"> <label for="id_cell" class=" requiredField">
                Cell<span class="asteriskField">*</span> </label>
                <div class=""> <select name="cell" class="selectmultiple form-control" required="" id="id_cell" multiple="">
                        <option value="4" selected>National-Total Urban-Sp-Punjab-Bahwalpur-City-Pan/Cigarette Shop-Handler-Sml
                        </option>
                        <option value="5">National-Total Rural-Sp-Punjab-Bahwalpur-Med-Rural-Gs-Gms-Handler-Ttl</option>
                        <option value="6">National-Total Rural-Sp-Punjab-Bahwalpur-Med-Rural-Ks-Handler-Ttl</option>
                        <option value="7">National-Total Urban-Sp-Punjab-Multan-Roa-General Store-Handler-Med</option>
                        <option value="8">National-Total Urban-Sp-Punjab-Multan-Roa-Kiosk/Hawker-Handler-Sml</option>
                        <option value="9">National-Total Urban-Sp-Punjab-Multan-Roa-Kiryana Store-Handler-Med</option>
                        <option value="10">National-Total Urban-Sp-Punjab-Multan-Roa-Kiryana Store-Handler-Sml</option>
                        <option value="11">National-Total Urban-Sp-Punjab-Multan-Roa-General Store-Handler-Sml</option>
                        <option value="12">National-Total Urban-Sp-Punjab-Multan-Roa-Pan/Cigarette Shop-Handler-Lrg</option>
                        <option value="13">National-Total Urban-Sp-Punjab-Multan-Roa-Pan/Cigarette Shop-Handler-Sml</option>
                        <option value="14">National-Total Rural-Sp-Punjab-Multan-Lrg-Rural-Gs-Gms-Handler-Ttl</option>
                        <option value="15">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-General Store-Handler-Sml</option>
                        <option value="16">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-General Store-Handler-Med</option>
                        <option value="17">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Kiosk/Hawker-Handler-Sml</option>
                        <option value="18">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Kiryana Store-Handler-Lrg</option>
                        <option value="19">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Kiryana Store-Handler-Med</option>
                        <option value="20">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Kiryana Store-Handler-Sml</option>
                        <option value="21">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Kiryana Store-Non Handler-Ttl
                        </option>
                        <option value="22">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Pan/Cigarette Shop-Handler-Sml
                        </option>
                        <option value="23">National-Total Urban-Sp-Punjab-Multan-City-General Store-Handler-Sml</option>
                        <option value="24">National-Total Urban-Sp-Punjab-Multan-City-Kiosk/Hawker-Handler-Lrg</option>
                        <option value="25">National-Total Urban-Sp-Punjab-Multan-City-Kiosk/Hawker-Handler-Med</option>
                        <option value="26">National-Total Urban-Sp-Punjab-Multan-City-Kiosk/Hawker-Handler-Sml</option>
                        <option value="27">National-Total Urban-Sp-Punjab-Multan-City-Pan/Cigarette Shop-Handler-Lrg
                        </option>
                        <option value="28">National-Total Urban-Sp-Punjab-Multan-City-Pan/Cigarette Shop-Handler-Sml
                        </option>
                        <option value="29">National-Total Urban-Sp-Punjab-Bahwalpur-City-General Store-Handler-Med</option>
                        <option value="30">National-Total Urban-Sp-Punjab-Bahwalpur-City-General Store-Handler-Sml</option>
                        <option value="31">National-Total Urban-Sp-Punjab-Bahwalpur-City-Kiryana Store-Handler-Med</option>
                        <option value="32">National-Total Urban-Sp-Punjab-Bahwalpur-City-Kiryana Store-Handler-Sml</option>
                        <option value="33">National-Total Urban-Sp-Punjab-Bahwalpur-City-Pan/Cigarette Shop-Handler-Med
                        </option>
                        <option value="34">National-Total Urban-Sp-Punjab-Bahwalpur-City-Roa-Departmental Store/Super
                            Markets-Total-Ttl</option>
                        <option value="35">National-Total Rural-Sp-Punjab-Bahwalpur-Lrg-Rural-Gs-Gms-Handler-Ttl</option>
                        <option value="36">National-Total Rural-Sp-Punjab-Bahwalpur-Lrg-Rural-Gs-Gms-Non Handler-Ttl
                        </option>
                        <option value="37">National-Total Rural-Sp-Punjab-Bahwalpur-Lrg-Rural-Kh-Ps-Pm-Total-Ttl</option>
                        <option value="38">National-Total Rural-Sp-Punjab-Bahwalpur-Med-Rural-Kh-Ps-Pm-Total-Ttl</option>
                        <option value="39">national-total rural-sp-punjab-bahwalpur-lrg-rural-ks-handler-ttl</option>
                        <option value="40">National-Total Rural-Sp-Punjab-Bahwalpur-Med-Rural-Ks-Non Handler-Ttl</option>
                        <option value="41">National-Total Rural-Sp-Punjab-Multan-Lrg-Rural-Ks-Handler-Ttl</option>
                        <option value="42">National-Total Rural-Sp-Punjab-Multan-Lrg-Rural-Kh-Ps-Pm-Total-Ttl</option>
                        <option value="43">National-Total Rural-Sp-Punjab-Multan-Med-Rural-Gs-Gms-Handler-Ttl</option>
                        <option value="44">National-Total Rural-Sp-Punjab-Multan-Med-Rural-Kh-Ps-Pm-Total-Ttl</option>
                        <option value="45">National-Total Rural-Sp-Punjab-Multan-Med-Rural-Ks-Handler-Ttl</option>
                        <option value="46">National-Total Urban-Sp-Punjab-Multan-City-Corner/Snack Shop-Handler-Ttl</option>
                        <option value="47">National-Total Urban-Sp-Punjab-Multan-City-Canteen-Total-Ttl</option>
                        <option value="48">National-Total Urban-Sp-Punjab-Multan-Roa-Kiosk/Hawker-Handler-Med</option>
                        <option value="49">National-Total Rural-Sp-Punjab-Bahwalpur-Med-Rural-Gs-Gms-Non Handler-Ttl
                        </option>
                        <option value="50">National-Total Urban-Sp-Punjab-Bahwalpur-City-General Store-Handler-Lrg</option>
                        <option value="51">National-Total Rural-Sp-Punjab-Bahwalpur-Med-Rural-Cant-Cs-Ep-Total-Ttl</option>
                        <option value="52">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Pan/Cigarette Shop-Handler-Med
                        </option>
                        <option value="53">National-Total Urban-Sp-Punjab-Bahwalpur-City-Kiryana Store-Handler-Lrg</option>
                        <option value="54">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Pan/Cigarette Shop-Handler-Lrg
                        </option>
                        <option value="55">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-General Store-Handler-Lrg</option>
                        <option value="56">National-Total Urban-Sp-Punjab-Multan-City-General Store-Handler-Med</option>
                        <option value="57">National-Total Urban-Sp-Punjab-Bahwalpur-City-General-Medical Store-Handler-Ttl
                        </option>
                        <option value="58">National-Total Urban-Sp-Punjab-Bahwalpur-City-Roa-Petro Mart-Total-Ttl</option>
                        <option value="59">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Kiosk/Hawker-Handler-Med</option>
                        <option value="60">National-Total Urban-Sp-Punjab-Multan-Roa-Canteen-Total-Ttl</option>
                        <option value="61">National-Total Urban-Sp-Punjab-Multan-Roa-Kiryana Store-Handler-Lrg</option>
                        <option value="62">National-Total Rural-Sp-Punjab-Multan-Lrg-Rural-Cant-Cs-Ep-Total-Ttl</option>
                        <option value="63">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Kiosk/Hawker-Handler-Lrg</option>
                        <option value="64">National-Total Rural-Sp-Punjab-Multan-Med-Rural-Gs-Gms-Non Handler-Ttl</option>
                        <option value="65">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Corner/Snack Shop-Non Handler-Ttl
                        </option>
                        <option value="66">National-Total Urban-Sp-Punjab-Multan-City-Eating Place/Highway Hotel-Total-Ttl
                        </option>
                        <option value="67">National-Total Urban-Sp-Punjab-Multan-City-Kiosk/Hawker-Non Handler-Ttl</option>
                        <option value="68">National-Total Urban-Sp-Punjab-Multan-City-Kiryana Store-Non Handler-Ttl</option>
                        <option value="69">National-Total Urban-Sp-Punjab-Bahwalpur-City-Corner/Snack Shop-Non Handler-Ttl
                        </option>
                        <option value="70">National-Total Urban-Sp-Punjab-Multan-Roa-Corner/Snack Shop-Non Handler-Ttl
                        </option>
                        <option value="71">National-Total Urban-Sp-Punjab-Multan-Roa-Eating Place/Highway Hotel-Total-Ttl
                        </option>
                        <option value="72">National-Total Urban-Sp-Punjab-Multan-Roa-General Store-Non Handler-Ttl</option>
                        <option value="73">National-Total Urban-Sp-Punjab-Multan-Roa-General-Medical Store-Non
                            Handler-Ttl@National-Total Urban-Sp-Punjab-Multan-Roa-Kiosk/Hawker-Non Handler-Ttl</option>
                        <option value="74">National-Total Urban-Sp-Punjab-Multan-Roa-Kiryana Store-Non Handler-Ttl</option>
                        <option value="75">National-Total Urban-Sp-Punjab-Bahwalpur-City-Roa-Canteen-Total-Ttl</option>
                        <option value="76">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Eating Place/Highway Hotel-Total-Ttl
                        </option>
                        <option value="77">National-Total Urban-Sp-Punjab-Multan-City-Corner/Snack Shop-Non Handler-Ttl
                        </option>
                        <option value="78">National-Total Urban-Sp-Punjab-Multan-City-General Store-Non Handler-Ttl</option>
                        <option value="79">National-Total Urban-Sp-Punjab-Multan-City-General-Medical Store-Non Handler-Ttl
                        </option>
                        <option value="80">National-Total Urban-Sp-Punjab-Bahwalpur-City-Eating Place/Highway
                            Hotel-Total-Ttl
                        </option>
                        <option value="81">National-Total Urban-Sp-Punjab-Bahwalpur-City-General Store-Non Handler-Ttl
                        </option>
                        <option value="82">National-Total Urban-Sp-Punjab-Bahwalpur-City-General-Medical Store-Non
                            Handler-Ttl
                        </option>
                        <option value="83">National-Total Rural-Sp-Punjab-Bahwalpur-Lrg-Rural-Cant-Cs-Ep-Total-Ttl</option>
                        <option value="84">National-Total Rural-Sp-Punjab-Bahwalpur-Lrg-Rural-Ks-Non Handler-Ttl</option>
                        <option value="85">National-Total Rural-Sp-Punjab-Multan-Lrg-Rural-Gs-Gms-Non Handler-Ttl</option>
                        <option value="86">National-Total Rural-Sp-Punjab-Multan-Med-Rural-Cant-Cs-Ep-Total-Ttl</option>
                        <option value="87">National-Total Rural-Sp-Punjab-Multan-Med-Rural-Ks-Non Handler-Ttl</option>
                        <option value="88">National-Total Urban-Sp-Punjab-Multan-City-Petro Mart-Total-Ttl</option>
                        <option value="89">National-Total Urban-Sp-Punjab-Bahwalpur-City-Kiryana Store-Non Handler-Ttl
                        </option>
                        <option value="90">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-General-Medical Store-Non
                            Handler-Ttl
                        </option>
                        <option value="91">National-Total Rural-Sp-Punjab-Multan-Lrg-Rural-Ks-Non Handler-Ttl</option>
                        <option value="92">National-Total Urban-Sp-Punjab-Bahwalpur-City-Pan/Cigarette Shop-Handler-Lrg
                        </option>
                        <option value="93">National-Total Urban-Sp-Punjab-Bahwalpur-City-Kiosk/Hawker-Total-Ttl</option>
                        <option value="94">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-General Store-Non Handler-Ttl
                        </option>
                        <option value="95">National-Total Urban-Sp-Punjab-Multan-Roa-Corner/Snack Shop-Handler-Ttl</option>
                        <option value="96">National-Total Urban-Sp-Punjab-Bahwalpur-City-Corner/Snack Shop-Handler-Ttl
                        </option>
                        <option value="97">National-Total Urban-Sp-Punjab-Multan-Roa-Pan/Cigarette Shop-Handler-Med</option>
                        <option value="98">National-Total Urban-Sp-Punjab-Multan-City-Kiryana Store-Handler-Lrg</option>
                        <option value="99">National-Total Urban-Sp-Punjab-Multan-City-Pan/Cigarette Shop-Handler-Med
                        </option>
                        <option value="100">National-Total Urban-Sp-Punjab-Multan-City-General-Medical Store-Handler-Ttl
                        </option>
                        <option value="101">National-Total Urban-Sp-Punjab-Multan-City-Kiryana Store-Handler-Sml</option>
                        <option value="102">National-Total Urban-Sp-Punjab-Multan-City-General Store-Handler-Lrg</option>
                        <option value="103">National-Total Urban-Sp-Punjab-Multan-Roa-Petro Mart-Total-Ttl</option>
                        <option value="104">National-Total Urban-SP-Punjab-Multan-City-ROA-Departmental Store/Super
                            Markets-Total-TTL</option>
                        <option value="105">National-Total Urban-SP-Punjab-Multan-ROA-Kiosk/Hawker-Handler-LRG</option>
                        <option value="106">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Kiosk/Hawker-Non Handler-Ttl
                        </option>
                        <option value="1">National-Total Urban-Sp-Punjab-Multan-Roa-General Store-Handler-Lrg</option>
                        <option value="107">National-Total Urban-Sp-Punjab-Multan-Roa-General-Medical Store-Handler-Ttl
                        </option>
                        <option value="2">National-Total Urban-Sp-Punjab-Bahwalpur-Roa-Corner/Snack Shop-Handler-Ttl
                        </option>
                        <option value="3">National-Total Urban-Sp-Punjab-Multan-City-Kiryana Store-Handler-Med</option>

                    </select> </div>
        </div>

    </div>

    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
        </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
        </script>
    <script src="jquery-3.6.0.min.js"></script>
    <script language="javascript">

        (function ($) {

            // convert a multiple select in a multiple checkbox
            var mselectTOmcheckbox = function mselectTOmcheckbox(selector) {

                var elements = $(selector);

                elements.each(function (index, item) {
                    var id = $(item).attr('id'),
                        name = $(item).attr('name'),
                        options = $(item).children();

                    var mcheckbox_table = $('<ul class="ul-el" />', {
                        id: 'mcheckbox-' + id,
                        className: 'table table-striped table-bordered dt-responsive nowrap mcheckbox-table'
                    }).appendTo(
                        mcheckbox_container = $('<div/>', {
                            className: 'mcheckbox-container'
                        })
                    );

                    options.each(function (index, option) {
                        var value = $(option).attr('value'),
                            label = $(option).text(),
                            selected = $(option).attr('selected');


                        var checkbox_row = $(
                            `<li class="list-items">
                          <label for="${name}_${value}" class="mcheckbox-label">
                            <input type="checkbox" id="${name}_${value}" class="check" name="${name}" value="${value}"  ${(selected ? 'checked="checked"' : '')}/><span>${label}</span>
                          </label>
                         </li>`
                        ).appendTo(mcheckbox_table);


                    })



                    mcheckbox_container.insertAfter(item);

                    try {
                        mcheckbox_container.resizable({ handles: "se" });
                    }
                    catch (e) {
                        // resizing not supported
                        console.log('resizing not supported');
                    }

                    $(item).nextAll('.help').hide();
                    $(item).remove();

                })

                let ulEl = document.getElementsByClassName("ul-el");
                let searchInput = document.getElementById("searchInput");
                let selectedCheck = document.getElementById("selected-check");
                let visibleNum = document.getElementById("visibleNum")


                renderUpdatedList = (list) => {
                    const parent = ulEl[0]

                    Array.from(parent.children).forEach(item => {
                        item.classList.add("active");
                    })
                    list.forEach(item => {
                        item.classList.remove("active");
                    })
                }

                let checkedOnInputChange = $('.ul-el .list-items input[type="checkbox"]:checked:visible').length;
                selectedCheck.textContent = `Selected Items : ${checkedOnInputChange}`

                jQuery('#searchInput').on('input keyup', function (event) {
                    let searchQuery = event.target.value.toLowerCase();
                    searchQuery = searchQuery.replaceAll('-', ' ').split(' ').filter(s => s);

                    let visibleItemNumber = $(".ul-el .list-items:visible").length;
                    visibleNum.textContent = visibleItemNumber;

                    let checkedOnInputChange = $('.ul-el .list-items input[type="checkbox"]:checked:visible').length;
                    selectedCheck.textContent = `Selected Items : ${checkedOnInputChange}`

                    let allNamesDOMCollection = $(".ul-el .list-items");
                    let result = [];
                    let includes;

                    for (listRecord of allNamesDOMCollection) {
                        let selector = listRecord.querySelector('span')
                        let currentName = selector.textContent.toLowerCase().replaceAll("-", " ").split(' ').filter(s => s).join(" ");
                        includes = true;
                        listRecord.classList.remove("active");
                        for (words of searchQuery) {
                            if (currentName.indexOf(words) === -1 || currentName.lastIndexOf(words) === -1) {
                                includes = false;
                                listRecord.classList.add("active");
                                break;
                            }

                            listRecord.classList.remove("active");
                        }

                        if (includes) {
                            result.push(listRecord);
                            renderUpdatedList(result);
                        }

                    }
                });


                let list = $(".ul-el"),
                    origOrderList = list.children();

                list.on("change", ":checkbox", function () {
                    let checked = $('.ul-el .list-items input[type="checkbox"]:checked:visible').length;
                    if ($(this).is(':checked')) {
                        selectedCheck.textContent = `Selected Items : ${checked}`
                    } else {
                        selectedCheck.textContent = `Selected Items :  ${checked--}`
                    }
                })


                function seeCheckedNum() {
                    let checked = $('.ul-el .list-items input[type="checkbox"]:checked:visible').length;
                    selectedCheck.textContent = `Selected Items : ${checked}`
                }


                var clicked = false;
                $(".btn-li-items .checkall").on("click", function () {
                    $(".ul-el .list-items .check:visible").prop("checked", !clicked);
                    clicked = !clicked;
                    seeCheckedNum()

                });

            };

            $(document).ready(function () {
                mselectTOmcheckbox('select[id="id_cell"]');
            })

        })(jQuery)

    </script>

</body>

</html>